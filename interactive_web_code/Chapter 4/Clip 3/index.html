<!DOCTYPE html>
<html lang="ko">

<head>
  <meta charset="UTF-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <link rel="stylesheet" href="./index.css">
  <title>Fast Bank</title>
</head>

<body>
  <div id="main-img-wrapper">
    <img width="320" src="./Lovepik_com-401339128-data-management-data-analysis-icon-free-vector-illustration-mate.png"
      alt="coding image">
  </div>
  <div id="intro-main">
    <p>이미 모두의 은행, 패스트뱅크</p>
    <p>함께 일해요.</p>
    <p id="join-us-text">Join us!</p>
    <img id="down-arrow-icon" src="./down-arrow.png" alt="down arrow icon">
  </div>
  <ul id="list-item-wrapper">
    <li class="list-item">26주적금</li>
    <li class="list-item">저금</li> 
    <li class="list-item">패스트캠퍼스</li>
    <li class="list-item">떡볶이</li>
    <li class="list-item">치킨</li>
    <li class="list-item">축구</li>
    <li class="list-item">축구선수</li>
    <li class="list-item">마이너스통장대출</li>
    <li class="list-item">26주적금</li>
    <li class="list-item">저금</li>
    <li class="list-item">패스트캠퍼스</li>
    <li class="list-item">떡볶이</li>
    <li class="list-item">치킨</li>
    <li class="list-item">축구</li>
    <li class="list-item">축구선수</li>
    <li class="list-item">마이너스통장대출</li>
    <li class="list-item">26주적금</li>
    <li class="list-item">저금</li>
    <li class="list-item">패스트캠퍼스</li>
    <li class="list-item">떡볶이</li>
    <li class="list-item">치킨</li>
    <li class="list-item">축구</li>
    <li class="list-item">축구선수</li>
    <li class="list-item">마이너스통장대출</li>
    <li class="list-item">26주적금</li>
    <li class="list-item">저금</li>
    <li class="list-item">패스트캠퍼스</li>
    <li class="list-item">떡볶이</li>
    <li class="list-item">치킨</li>
    <li class="list-item">축구</li>
    <li class="list-item">축구선수</li>
    <li class="list-item">마이너스통장대출</li>
  </ul>
  <main>
    <section id="panel1-img">
      <img id="flying-santa-image" src="./santa_flying.png" alt="santa flying">
    </section>
  </main>
</body>

<script>
  const listStyleChangeStartY = 373
  const listStyleChangeEndY = 1585

  const listItems = document.querySelectorAll('.list-item')

  const division = (listStyleChangeEndY - listStyleChangeStartY) / listItems.length

  const panel1Img = document.getElementById('panel1-img')
  const flyingSantaImage = document.getElementById('flying-santa-image')

  window.addEventListener("scroll", () => {
    if (document.getElementById("on")) document.getElementById("on").removeAttribute("id")

    if (window.scrollY > listStyleChangeStartY && window.scrollY < listStyleChangeEndY) {
      const targetIndex = Math.round((window.scrollY - listStyleChangeStartY) / division)

      if (listItems[targetIndex]) listItems[targetIndex].id = "on"
    }

    // NOTE: document.documentElement.clientHeight는 뷰포트, client 브라우저 높이인 듯
    // window.scrollY는 시작 지점인데, 아래는 끝 지점
    const scrollYBottom = window.scrollY + document.documentElement.clientHeight

    console.log("window.scrollY", window.scrollY)
    console.log("document.documentElement.clientHeight", document.documentElement.clientHeight)
    console.log("scrollYBottom", scrollYBottom)
    console.log("panel1Img.offsetTop", panel1Img.offsetTop)
    console.log("panel1Img.offsetHeight", panel1Img.offsetHeight)

    // NOTE: 100을 더하는 이유는 100px 정도 더 지났을 때 기울이고 싶어서
    // panel1Img.offsetTop 는 0부터 떨어진 수치
    if (scrollYBottom > panel1Img.offsetTop && scrollYBottom < panel1Img.offsetTop + panel1Img.offsetHeight + 100) {
      /**
      // - 80은 초기 위치 (css),  
        - scrollYBottom - panel1Img.offsetTop: 
        - offsetTop은 HTML 요소의 위쪽 경계(top border)가 요소의 오프셋 부모 요소(보통 가장 가까운 position이 relative, absolute, fixed로 설정된 요소 또는 body 태그)로부터 얼마나 떨어져 있는지를 픽셀 단위로 반환합니다.
        - offsetHeight은 HTML 요소의 전체 높이를 픽셀 단위로 반환합니다. 여기에는 요소의 콘텐츠, 패딩, 그리고 상하 경계(border)의 두께가 모두 포함됩니다.
       **/
      // NOTE: top으로부터 얼마나 지났는지 0~420 까지의 값 (100 + 320 높이)
      console.log("1111 ", (scrollYBottom - panel1Img.offsetTop) )
      // NOTE: 고정값 100px을 더해주는 이유는, 100px 지나면 기울이고 싶어서
      console.log("2222 ", (panel1Img.offsetHeight + 100) )

      // 0~1사이
      console.log("3333 ", (scrollYBottom - panel1Img.offsetTop) / (panel1Img.offsetHeight + 100))
      const translateX = 80 - 80 * 1.3 * (scrollYBottom - panel1Img.offsetTop) / (panel1Img.offsetHeight + 100)
      const translateY = -13 + 13 * (scrollYBottom - panel1Img.offsetTop) / (panel1Img.offsetHeight + 100)

      // NOTE: 23도에서 시작해서 23도에서 1.7배로 줄어들어서 0도가 되게
      // 23 ~ 16 정도까지
      const rotationDegree = 23 - 23 * 1.7 * (scrollYBottom - panel1Img.offsetTop) / (panel1Img.offsetHeight + 100)

      console.log("translateX", translateX)
      console.log("translateY", translateY)
      console.log("rotationDegree", rotationDegree)

      flyingSantaImage.style.transform = `translate(${translateX}px, ${translateY}px) rotate(${rotationDegree}deg)`
    }
  })

</script>

</html>